(()=>{"use strict";var e={607:function(e,o,r){var t=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(o,"__esModule",{value:!0});const i=t(r(860)),n=r(87),l=r(796),a=t(r(147)),s=t(r(17)),c=t(r(167)),d=(0,i.default)(),{PORT:p=3006}=process.env;d.get("/",((e,o)=>{o.send({message:"hello world"})})),d.listen(p,(()=>{console.log("server started on port:"+p)}));const u="https://todoinsumos.com/api",f=(0,n.io)("ws://todoinsumos.com:4000",{reconnectionDelayMax:1e4});f.on("print-tag-order",(e=>{const{boxes:o,name:r,phone:t,address:i,city:n,details:l}=e,c=s.default.join(__dirname,"../../cns-local/etiquetas/");a.default.writeFile(c+"envio.txt",`${o};${r};${t};${i};${n};${l}`,(e=>{e?console.warn(e):console.log("Etiqueta pedido ",r)}))})),f.on("print-tag-product",(({codigo_pr:e,nombre_pr:o})=>{const r=s.default.join(__dirname,"../../cns-local/etiquetas/label/");a.default.writeFile(r+"label.txt",`SKU: ${e};${o}`,(e=>{e?console.warn(e):console.log("Etiqueta producto ",o)}))})),f.on("print-invoice",(e=>{(0,c.default)({url:`${u}/invoices/pdf`,method:"GET",responseType:"arraybuffer",headers:{authorization:e.authorization,uid:e.cliente_id,pid:e.pedido_id,fid:e.factura_id}}).then((e=>{a.default.createWriteStream("../cns-local/invoice.pdf").write(Buffer.from(e.data,"utf8"),(e=>{e&&console.log(e),(0,l.print)("../cns-local/invoice.pdf",{printer:"EPSON_XP_2100_Series",win32:['-print-settings "fit"']}).then((()=>{console.log("Factura impresa"),a.default.unlink("../cns-local/invoice.pdf",console.log)})).catch((()=>{console.log("Error al imprimir factura"),a.default.unlink("../cns-local/invoice.pdf",console.log)}))}))})).catch((e=>{console.log(e)}))})),f.on("print-order",(e=>{(0,c.default)({url:`${u}/orders/pdf`,method:"POST",responseType:"arraybuffer",headers:{authorization:e.authorization},data:{cliente_id:e.cliente_id,pedido_id:e.pedido_id}}).then((e=>{a.default.createWriteStream("../cns-local/order2.pdf").write(Buffer.from(e.data),(e=>{e&&console.log("error escribiendo archivo"),(0,l.print)("../cns-local/order.pdf",{printer:"EPSON_XP_2100_Series",win32:['-print-settings "fit"']}).then((()=>{console.log("Remito impreso"),a.default.unlink("../cns-local/order.pdf",console.log)})).catch((()=>{console.log("Error al imprimir remito"),a.default.unlink("../cns-local/order.pdf",console.log)}))}))})).catch((e=>{console.log("Error axios",e)}))}))},167:e=>{e.exports=require("axios")},860:e=>{e.exports=require("express")},796:e=>{e.exports=require("pdf-to-printer")},87:e=>{e.exports=require("socket.io-client")},147:e=>{e.exports=require("fs")},17:e=>{e.exports=require("path")}},o={};(function r(t){var i=o[t];if(void 0!==i)return i.exports;var n=o[t]={exports:{}};return e[t].call(n.exports,n,n.exports,r),n.exports})(607)})();