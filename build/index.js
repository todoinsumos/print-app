(()=>{"use strict";var e={607:function(e,o,t){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(o,"__esModule",{value:!0});const n=r(t(860)),l=t(87),i=t(393),a=r(t(147)),s=r(t(17)),c=r(t(167)),d=(0,n.default)(),{PORT:u=3006}=process.env;d.get("/",((e,o)=>{o.send({message:"hello world"})})),d.listen(u,(()=>{console.log(`server started at http://${p}:`+u)}));const p="localhost",f=(0,l.io)(`ws://${p}:4000`,{reconnectionDelayMax:1e4});f.on("print-tag-order",(e=>{const{boxes:o,name:t,phone:r,address:n,city:l,details:i}=e,c=s.default.join(__dirname,"../../cns-local/etiquetas/");a.default.writeFile(c+"envio.txt",`${o};${t};${r};${n};${l};${i}`,(e=>{e?console.warn(e):console.log("Etiqueta pedido ",t)}))})),f.on("print-tag-product",(({codigo_pr:e,nombre_pr:o})=>{const t=s.default.join(__dirname,"../../cns-local/etiquetas/label/");a.default.writeFile(t+"label.txt",`SKU: ${e};${o}`,(e=>{e?console.warn(e):console.log("Etiqueta producto ",o)}))})),f.on("print-invoice",(e=>{(0,c.default)({url:`http://${p}:3000/invoices/pdf`,method:"GET",responseType:"arraybuffer",headers:{authorization:e.authorization,uid:e.cliente_id,pid:e.pedido_id,fid:e.factura_id}}).then((e=>{a.default.createWriteStream("../cns-local/invoice.pdf").write(Buffer.from(e.data,"utf8"),(e=>{e&&console.log(e),(0,i.print)("../cns-local/invoice.pdf","EPSON_XP_2100_Series",["-o media=A4"]).then((e=>{console.log(e),a.default.unlink("../cns-local/invoice.pdf",console.log)})).catch((e=>{console.log(e),a.default.unlink("../cns-local/invoice.pdf",console.log)}))}))})).catch((e=>{console.log(e)}))})),f.on("print-order",(e=>{(0,i.getPrinters)().then(console.log),(0,c.default)({url:`http://${p}:3000/orders/pdf`,method:"POST",responseType:"arraybuffer",headers:{authorization:e.authorization},data:{cliente_id:e.cliente_id,pedido_id:e.pedido_id}}).then((e=>{a.default.createWriteStream("../cns-local/order.pdf").write(Buffer.from(e.data,"utf8"),(e=>{e&&console.log(e),(0,i.print)("../cns-local/order.pdf","EPSON_XP_2100_Series",["-o media=A4"]).then((e=>{console.log(e),a.default.unlink("../cns-local/order.pdf",console.log)})).catch((e=>{console.log(e),a.default.unlink("../cns-local/order.pdf",console.log)}))}))})).catch((e=>{console.log(e)}))}))},167:e=>{e.exports=require("axios")},860:e=>{e.exports=require("express")},87:e=>{e.exports=require("socket.io-client")},393:e=>{e.exports=require("unix-print")},147:e=>{e.exports=require("fs")},17:e=>{e.exports=require("path")}},o={};(function t(r){var n=o[r];if(void 0!==n)return n.exports;var l=o[r]={exports:{}};return e[r].call(l.exports,l,l.exports,t),l.exports})(607)})();